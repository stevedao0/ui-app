{% extends "base.html" %}
{% block content %}
<div style="max-width: 900px; margin: 0 auto;">
  <div class="card" style="margin-bottom: var(--space-8); overflow: visible;">
    <div class="card-header" style="background: linear-gradient(135deg, rgba(59, 130, 246, 0.05) 0%, rgba(255, 255, 255, 1) 100%); border-bottom: 2px solid var(--primary-200); padding: var(--space-8);">
      <div style="display: flex; align-items: center; gap: var(--space-4); margin-bottom: var(--space-3);">
        <div class="icon-container icon-container-primary" style="width: 56px; height: 56px;">
          <svg style="width: 28px; height: 28px; color: white;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
          </svg>
        </div>
        <div>
          <h1 class="card-title" style="margin: 0; font-size: var(--text-3xl); color: var(--primary-800);">
            Upload danh mục Excel
          </h1>
          <p style="font-size: var(--text-sm); color: var(--text-secondary); margin: var(--space-1) 0 0 0;">
            Upload file danh mục Excel đã điền đầy đủ để lưu trên server
          </p>
        </div>
      </div>
    </div>

    <div class="card-body" style="padding: var(--space-8);">
      {% if error %}
        <div class="alert alert-error" style="margin-bottom: var(--space-6);">
          <svg class="alert-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
          <div class="alert-content">
            <div class="alert-message">{{ error }}</div>
          </div>
        </div>
      {% endif %}

      {% if message %}
        <div class="alert alert-success" style="margin-bottom: var(--space-6);">
          <svg class="alert-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
          <div class="alert-content">
            <div class="alert-message">{{ message }}</div>
          </div>
        </div>
      {% endif %}

      <form method="post" action="/catalogue/upload" enctype="multipart/form-data" data-loading>
        <input type="hidden" name="year" value="{{ year }}" />

        <div class="form-section-primary" style="margin-bottom: var(--space-6);">
          <div style="display: flex; align-items: center; gap: var(--space-2); margin-bottom: var(--space-4);">
            <svg style="width: 20px; height: 20px; color: var(--primary-600);" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
            </svg>
            <h3 style="margin: 0; font-size: var(--text-lg); font-weight: var(--font-semibold); color: var(--primary-800);">Thông tin tài liệu</h3>
          </div>

          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: var(--space-4);">
            <div class="form-group" style="margin: 0;">
              <label class="form-label">
                Số hợp đồng
                <span style="color: var(--error-600);">*</span>
              </label>
              <input class="form-input" type="text" name="contract_no" value="{{ contract_no or '' }}" required placeholder="Nhập số hợp đồng" />
            </div>

            <div class="form-group" style="margin: 0;">
              <label class="form-label">Số phụ lục (tùy chọn)</label>
              <input class="form-input" type="text" name="annex_no" value="{{ annex_no or '' }}" placeholder="Để trống nếu là hợp đồng" />
            </div>
          </div>
        </div>

        <div class="form-section-info" style="margin-bottom: var(--space-8);">
          <div style="display: flex; align-items: center; gap: var(--space-2); margin-bottom: var(--space-4);">
            <svg style="width: 20px; height: 20px; color: var(--info-600);" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z" />
            </svg>
            <h3 style="margin: 0; font-size: var(--text-lg); font-weight: var(--font-semibold); color: var(--info-800);">File danh mục</h3>
          </div>

          <div class="form-group" style="margin: 0;">
            <label class="form-label">
              Chọn file Excel
              <span style="color: var(--error-600);">*</span>
            </label>
            <div style="position: relative; border: 2px dashed var(--info-300); border-radius: var(--radius-lg); padding: var(--space-8); background: linear-gradient(135deg, var(--info-50) 0%, white 100%); text-align: center; transition: all var(--transition-base);" onmouseover="this.style.borderColor='var(--info-500)'; this.style.background='linear-gradient(135deg, var(--info-100) 0%, white 100%)'" onmouseout="this.style.borderColor='var(--info-300)'; this.style.background='linear-gradient(135deg, var(--info-50) 0%, white 100%)'">
              <svg style="width: 48px; height: 48px; color: var(--info-400); margin: 0 auto var(--space-3);" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
              </svg>
              <p style="font-size: var(--text-base); color: var(--text-primary); font-weight: var(--font-medium); margin: 0 0 var(--space-1);">
                Chọn file Excel (.xlsx)
              </p>
              <p style="font-size: var(--text-sm); color: var(--text-tertiary); margin: 0;">
                Kéo thả file vào đây hoặc click để chọn
              </p>
              <input class="form-input" type="file" name="catalogue_file" accept=".xlsx" required style="position: absolute; inset: 0; opacity: 0; cursor: pointer;" />
            </div>
          </div>
        </div>

        <div style="display: flex; gap: var(--space-3); flex-wrap: wrap; padding-top: var(--space-4); border-top: 1px solid var(--border);">
          <button class="btn btn-primary" type="submit" style="display: inline-flex; align-items: center; gap: var(--space-2); padding: var(--space-3) var(--space-6);">
            <svg style="width: 20px; height: 20px;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
            </svg>
            Upload danh mục
          </button>
          <a class="btn btn-secondary" href="/contracts?year={{ year }}" style="display: inline-flex; align-items: center; gap: var(--space-2);">
            <svg style="width: 20px; height: 20px;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
            </svg>
            Quay lại
          </a>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
